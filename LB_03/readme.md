# Лабораторная работа №3

В данной работе нужно научиться предсказывать среднюю цену на апартаменты за ночь, целевая метрика — `MAE`.

Данные взяты отсюда: https://www.kaggle.com/PromptCloudHQ/airbnb-property-data-from-texas (некоторые столбцы удалены, записи перемешаны случайным образом).

В качестве результата данной работы у вас должен быть файл с отчетом и два файла с предсказаниями: один для линейной модели и один для бустинг-модели.

Установите библиотеку `NLTK` (в `Anaconda Prompt` выполнить `conda install nltk`).

1. Скачайте данные https://drive.google.com/file/d/1QOYQrSZ9S7RZM3UGLGaBBK0gE7h0RRd0/view?usp=sharing.
2. Проведите разведочный анализ данных.
3. Потренируйтесь предобрабатывать тексты при помощи стемминга, лемматизации, удаления стоп-слов. 
4. Посмотрите пример работы с текстами в sklearn: http://scikit-learn.org/stable/tutorial/text_analytics/working_with_text_data.html.
5. Постройте матрицы частот встречаемости токенов в документах для столбца `description` (`CountVectorizer`/`TfidfVectorizer`).
5. Обучите линейные модели `SGDRegressor` с различными параметрами на матрице из предыдущего пункта. Какую функция потерь дает лучший результат?
6. Понизьте размерность данных и обучите бустинг-модели с различными параметрами. С какой новой размерностью у вас получается лучший результат? Получилось ли у вас получить качество выше, чем у линейных моделей? 
7. Обучите модели на различных входных данных и ответьте на следующие вопросы:
    * Что в данной задаче работает лучше: стемминг или лемматизация? 
    * Дают ли стоп-слова прирост в качестве?
    * На какой матрице слов лучше обучать модели: построенной с использованием `CountVectorizer` или `TfidfVectorizer`?
    * Лучше работает модель на основе N-грамм или слов?
    * Какое значение для параметра `min_df` целесообразно использовать? Как сильно зависит целевая метрика/время обучения от данного параметра?
    * Использование какого столбца `description` или `title` дает лучший результат? Сильно ли он увеличивается, если обучать модель сразу на всех текстовых столбцах?
    * Оправдано ли, на ваш взгляд, использование бустинга в данной задаче?
8. Попробуйте провести другие эксперименты, чтобы улучшить качество моделей, например:
    * Более продвинутый препроцессинг
    * Оптимизация гиперпараметров моделей
9. Использую результаты предыдущих пунктов постройте два пайплайна: один для линейной модели, второй для бустинг-модели. Обучите их и предскажите результаты для тестовых данных, результаты сохраните в файлы `submission_linear_ФамилияИмя` и `submission_boosting_ФамилияИмя`.

Обратите внимание, что кросс-валидацию необходимо проводить сразу для <b>ВСЕГО</b> пайплайна. 

У вас будет только <b>ОДНА</b> попытка отправить предсказания. Итоговый результат рассчитывается как среднее значение целевой метрики для двух файлов.

Ваша оценка зависит как от результата на тестовых данных, так и от отчета.

**Срок сдачи работы лабораторной: 12 октября 2018.**
